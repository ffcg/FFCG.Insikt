@{
    Layout = null;
}

<!DOCTYPE html>

<html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title></title>
        <link href="./Styles/battleshipp.css" type="text/css" rel="stylesheet"/>
    </head>
    <body>
        <div>
            <input type="button" value="Join game!" id="joingamebutton" />
            <h1 id="status"></h1>
        
            @{
                for (var i = 0; i < 10; i++)
                {
                    <div class="row">
                        @{
                            for (var j = 0; j < 10; j++)
                            {
                                <div class="column" data-x="@i" data-y="@j"></div>
                            }
                        }
                    </div>
                }
            }
        </div>
        <!--Script references. -->
        <!--Reference the jQuery library. -->
        <script src="../Scripts/jquery-1.6.4.min.js"></script>
        <!--Reference the SignalR library. -->
        <script src="../Scripts/jquery.signalR-2.2.0.min.js"></script>
        <!--Reference the autogenerated SignalR hub script. -->
        <script src="../signalr/hubs"></script>
        <script type="text/javascript">

            var globalPlayerId;

            $(function() {
                // Declare a proxy to reference the hub.
                var hub = $.connection.battleshipHub;
                $.connection.hub.start();

                // Create a function that the hub can call to broadcast messages.
                hub.client.gameIsWaitingForSecondPlayer = function(gameId) {
                    $('#status').text("Waiting for another player");
                };

                hub.client.gameHasBeenStarted = function(gameId) {
                    $('#status').text("Oppenent connected");
                };

                hub.client.allShipsHaveBeenPlaced = function (gameId, activePlayerId) {
                    $('#status').text("GameOn!!");
                };
            });

            $("#joingamebutton").click(function() {
                $.ajax("game/join/player", {
                        type: "post",
                        contentType: "text/plain"
                    })
                    .done(function (playerId) {
                    alert(playerId);
                        globalPlayerId = playerId;
                    });
            });

            $(".column").click(function() {
                $.ajax("game/placeship", {
                    type: "post",
                    data: JSON.stringify(
                    {
                        PlayerId : globalPlayerId,
                        X : 0,
                        Y: 0
                    }),
                    contentType: "application/json"
                });
            });
        </script>
    </body>
</html>